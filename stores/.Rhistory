)
fragmentation_index_bloc <- read_xlsx("Geofragmentation Index/bloc_factors_fallf_QML.xlsx")
fragmentation_index_ctry <- read_xlsx("Geofragmentation Index/bloc_factor_countries_QML.xlsx")
fragmentation_index_Villaverde <- read_xlsx("Geofragmentation Index/Villaverde.xlsx")
fragmentation_index_Villaverde <- fragmentation_index_Villaverde[101:nrow(fragmentation_index_Villaverde),]
fragmentation_index_reg <- read_xlsx("Geofragmentation Index/bloc_factors_reg_PPP_QML.xlsx")
fragmentation_index_reg <- read_xlsx("Geofragmentation Index/bloc_factors_reg_PPP_QML.xlsx")
fragmentation_index_reg_new <- read_xlsx("var_data/geofrag_reg_factor.xlsx")
VIX <- read_xlsx("VIX/VIX.xlsx",sheet = "Data")
WTI <- read_xlsx("WTI/WTI.xlsx",sheet = "Data")
USTreasury <- read_xlsx("treasury_2year_spread/treasury2yearspread.xlsx", sheet = "Data")
NFCI <- read_xlsx("NFCI/NFCI.xlsx", sheet = "data")
ip <- read_xlsx("industrial production/ip_IMF.xlsx",sheet = "Data")
fi <- read_xlsx("fixed_investment/gross_fixed_investment_IMF.xlsx", sheet = "data")
sp <- read_xlsx("Stock Exchange/Stock Exchanger.xlsx", sheet = "Data")
fi$iso3 <- countrycode(fi$COUNTRY, origin = 'country.name', destination = 'iso3c')
ip$iso3 <- countrycode(ip$COUNTRY, origin = 'country.name', destination = 'iso3c')
countries <- c(unlist(fi$iso3))
ip <- ip %>% filter(iso3 %in% countries)
ip <- ip %>% pivot_longer(cols = -c(COUNTRY,iso3),names_to = "Quarter", values_to = "Value") %>%
select(-COUNTRY) %>% pivot_wider(names_from = iso3, values_from = Value) %>%  mutate(across(
.cols = -Quarter,  # replace with your column name (unquoted)
.fns = log
))
fi <- fi %>% pivot_longer(cols = -c(COUNTRY,iso3),names_to = "Quarter", values_to = "Value") %>%
select(-COUNTRY) %>% pivot_wider(names_from = iso3, values_from = Value) %>%  mutate(across(
.cols = -Quarter,  # replace with your column name (unquoted)
.fns = log
))
var <- names(fi)
sp <- sp %>% pivot_longer(-Quarter,names_to = "iso3", values_to = "Value") %>% filter(iso3 %in% countries) %>%
pivot_wider(names_from = iso3, values_from = Value) %>%  mutate(across(
.cols = -Quarter,  # replace with your column name (unquoted)
.fns = log
)) %>% select(var)
sp$Quarter <- ip$Quarter
NFCI <- NFCI %>%
bind_cols(replicate(29, NFCI$NFCI, simplify = FALSE) |>
setNames(paste0("your_column_", 1:29)))
names(NFCI) <- var
NFCI$Quarter <- ip$Quarter
USTreasury <- USTreasury %>%  bind_cols(replicate(29, USTreasury$`2_year_treasury`, simplify = FALSE) |>
setNames(paste0("your_column_", 1:29)))
names(USTreasury) <- var
USTreasury$Quarter <- ip$Quarter
VIX <- VIX %>%  bind_cols(replicate(29, VIX$VIX, simplify = FALSE) |>
setNames(paste0("your_column_", 1:29)))
names(VIX) <- var
VIX$Quarter <- ip$Quarter
WTI <- WTI %>%  bind_cols(replicate(29, WTI$WTI, simplify = FALSE) |>
setNames(paste0("your_column_", 1:29)))
names(WTI) <- var
WTI$Quarter <- ip$Quarter
fragmentation_index <- fragmentation_index_bloc %>% select(Quarter, wld) %>%
bind_cols(replicate(29, fragmentation_index_bloc$wld, simplify = FALSE) |>
setNames(paste0("your_column_", 1:29))) %>% mutate(across(-Quarter, scale))
names(fragmentation_index) <- var
fragmentation_index$Quarter <- ip$Quarter
fragmentation_index_Villaverde <- fragmentation_index_Villaverde %>% select(Time, wld) %>%
bind_cols(replicate(29, fragmentation_index_Villaverde$wld, simplify = FALSE) |>
setNames(paste0("your_column_", 1:29))) %>% mutate(across(-Time, scale))
names(fragmentation_index_Villaverde) <- var
fragmentation_index_Villaverde$Quarter <- ip$Quarter[1:97]
fragmentation_index_reg_wld <-  fragmentation_index_reg %>% select(Quarter, wld) %>%
bind_cols(replicate(29, fragmentation_index_reg$wld, simplify = FALSE) |>
setNames(paste0("your_column_", 1:29))) %>% mutate(across(-Quarter, scale))
names(fragmentation_index_reg_wld) <- var
fragmentation_index_reg_wld$Quarter <- ip$Quarter
fragmentation_index_ctry <- fragmentation_index_ctry %>% select(var) %>% mutate(across(-Quarter, scale))
fragmentation_index_ctry$Quarter <- ip$Quarter
# Creating the fragmentation base for bloc
fragmentation_index_reg_ctry <-  fragmentation_index_reg%>% select(Quarter)
for (ctry in var[-1]){
if (ctry %in% us_eu_bloc){
fragmentation_index_reg_ctry[[ctry]] <- fragmentation_index_reg[["useu"]]
}
if (ctry %in% latin_america_bloc){
fragmentation_index_reg_ctry[[ctry]] <- fragmentation_index_reg[["lac"]]
}
if (ctry %in% other_countries_bloc){
fragmentation_index_reg_ctry[[ctry]] <- fragmentation_index_reg[["other"]]
}
if (ctry %in% chn_rus_bloc){
fragmentation_index_reg_ctry[[ctry]] <- fragmentation_index_reg[["chnrus"]]
}
}
fragmentation_index_reg_ctry_new <-  fragmentation_index_reg%>% select(Quarter)
for (ctry in var[-1]){
if (ctry %in% us_eu_bloc){
fragmentation_index_reg_ctry_new[[ctry]] <- fragmentation_index_reg_new[["useu"]]
}
if (ctry %in% latin_america_bloc){
fragmentation_index_reg_ctry_new[[ctry]] <- fragmentation_index_reg_new[["lac"]]
}
if (ctry %in% other_countries_bloc){
fragmentation_index_reg_ctry_new[[ctry]] <- fragmentation_index_reg_new[["other"]]
}
if (ctry %in% chn_rus_bloc){
fragmentation_index_reg_ctry_new[[ctry]] <- fragmentation_index_reg_new[["chnrus"]]
}
}
fragmentation_index_reg_ctry <- fragmentation_index_reg_ctry %>% select(var) %>% mutate(across(-Quarter, scale))
fragmentation_index_reg_ctry_new <- fragmentation_index_reg_ctry_new %>% select(var) %>% mutate(across(-Quarter, scale))
fragmentation_index_reg_ctry$Quarter <- ip$Quarter
fragmentation_index_reg_ctry_new$Quarter <- ip$Quarter
fragmentation_index_reg_ctry <- fragmentation_index_reg_ctry %>% select(var) %>% mutate(across(-Quarter, scale))
fragmentation_index_reg_ctry_new <- fragmentation_index_reg_ctry_new %>% select(var) %>% mutate(across(-Quarter, scale))
fragmentation_index_reg_ctry$Quarter <- ip$Quarter
fragmentation_index_reg_ctry_new$Quarter <- ip$Quarter
fragmentation_index_bloc_ctry <-  fragmentation_index_bloc %>% select(Quarter)
for (ctry in var[-1]){
if (ctry %in% us_eu_bloc){
fragmentation_index_bloc_ctry[[ctry]] <- fragmentation_index_bloc[["useu"]]
}
if (ctry %in% latin_america_bloc){
fragmentation_index_bloc_ctry[[ctry]] <- fragmentation_index_bloc[["lac"]]
}
if (ctry %in% other_countries_bloc){
fragmentation_index_bloc_ctry[[ctry]] <- fragmentation_index_bloc[["other"]]
}
if (ctry %in% chn_rus_bloc){
fragmentation_index_bloc_ctry[[ctry]] <- fragmentation_index_bloc[["chnrus"]]
}
}
fragmentation_index_bloc_ctry <- fragmentation_index_bloc_ctry %>% select(var) %>% mutate(across(-Quarter, scale))
fragmentation_index_bloc_ctry$Quarter <- ip$Quarter
# Desason sp, ip, and FI
deseasonalize <- function(x) {
# If too many NAs or too short, return as is
ts_x <- ts(x, frequency = 4,start= c(2000,1))  # quarterly
out <- final(seas(ts_x, x11 = "")) # fallback if fails
return(out)
}
ip <- ip %>% mutate(across(-Quarter, deseasonalize)) %>%
mutate(across(-Quarter, ~ rollsum(.x, 4, fill = NA, align = "right")))
fi <- fi %>% mutate(across(-Quarter, deseasonalize))%>%
mutate(across(-Quarter, ~ rollsum(.x, 4, fill = NA, align = "right")))
sp <- sp %>% mutate(across(-Quarter, deseasonalize))
# Saving the files
write_xlsx(ip,"var_data/ip.xlsx")
write_xlsx(fi,"var_data/fi.xlsx")
write_xlsx(sp,"var_data/sp.xlsx")
write_xlsx(NFCI,"var_data/NFCI.xlsx")
write_xlsx(USTreasury,"var_data/USTreasury.xlsx")
write_xlsx(VIX,"var_data/VIX.xlsx")
write_xlsx(WTI,"var_data/WTI.xlsx")
write_xlsx(fragmentation_index,"var_data/fragmentation_wld.xlsx")
write_xlsx(fragmentation_index_ctry,"var_data/fragmentation_ctry.xlsx")
write_xlsx(fragmentation_index_Villaverde,"var_data/fragmentation_ctry_Villaverde.xlsx")
write_xlsx(fragmentation_index_reg_wld,"var_data/fragmentation_index_reg_wld.xlsx")
#-------------------------------------------------------------------------------
ip_long <- ip %>% pivot_longer(cols = -Quarter,names_to = "country", values_to = "values") %>% mutate(Variable = "ip")
sp_long <- sp %>% pivot_longer(cols = -Quarter,names_to = "country", values_to = "values") %>% mutate(Variable = "sp")
fi_long <- fi %>% pivot_longer(cols = -Quarter,names_to = "country", values_to = "values") %>% mutate(Variable = "fi")
NFCI_long <- NFCI %>% pivot_longer(cols = -Quarter,names_to = "country", values_to = "values") %>% mutate(Variable = "NFCI")
USTreasury_long <- USTreasury %>% pivot_longer(cols = -Quarter,names_to = "country", values_to = "values") %>% mutate(Variable = "USTreasury")
WTI_long <- WTI %>% pivot_longer(cols = -Quarter,names_to = "country", values_to = "values") %>% mutate(Variable = "WTI")
VIX_long <- VIX %>% pivot_longer(cols = -Quarter,names_to = "country", values_to = "values") %>% mutate(Variable = "VIX")
fragmentation_index_long <- fragmentation_index %>% pivot_longer(cols = -Quarter,names_to = "country", values_to = "values") %>% mutate(Variable = "fragmentation_index")
fragmentation_index_ctry_long <- fragmentation_index_ctry %>% pivot_longer(cols = -Quarter,names_to = "country", values_to = "values") %>% mutate(Variable = "fragmentation_index_ctry")
fragmentation_index_Villaverde_long <- fragmentation_index_Villaverde %>% pivot_longer(cols = -Quarter,names_to = "country", values_to = "values") %>% mutate(Variable = "fragmentation_index_Villaverde")
fragmentation_index_reg_wld_long <- fragmentation_index_reg_wld %>% pivot_longer(cols = -Quarter,names_to = "country", values_to = "values") %>% mutate(Variable = "fragmentation_index_reg_wld")
fragmentation_index_reg_ctry_long <- fragmentation_index_reg_ctry %>% pivot_longer(cols = -Quarter,names_to = "country", values_to = "values") %>% mutate(Variable = "fragmentation_index_reg_ctry")
fragmentation_index_reg_ctry_new_long <- fragmentation_index_reg_ctry_new %>% pivot_longer(cols = -Quarter,names_to = "country", values_to = "values") %>% mutate(Variable = "fragmentation_index_reg_ctry")
data_var <- rbind(ip_long,sp_long,fi_long,NFCI_long,VIX_long, USTreasury_long,WTI_long,fragmentation_index_long,fragmentation_index_ctry_long,
fragmentation_index_Villaverde_long,fragmentation_index_reg_wld_long,fragmentation_index_reg_ctry_long,fragmentation_index_reg_ctry_new_long)
data_var <- data_var %>% pivot_wider(names_from = "Variable", values_from = "values")
View(fragmentation_index_reg_ctry_new_long)
library(readxl)
library(tidyverse)
library(writexl)
library(seasonal)
library(countrycode)
setwd("C:/Users/lveras/OneDrive - FLAR/Work/Actividades/Geoconomic Fragmentation/Data/")
# Variabes Globales
# Creating an world database based on GPR
us_eu_bloc <- c(
"USA",  # United States
"BEL",  # Belgium
"FRA",  # France
"DEU",  # Germany
"ITA",  # Italy
"NLD",  # Netherlands
"DNK",  # Denmark
"ESP",  # Spain
"FIN",  # Finland
"SWE",  # Sweden
"PRT",  # Portugal
"POL",  # Poland
"GBR"   # United Kingdom
)
chn_rus_bloc <- c(
"CHN",  # China
"RUS",  # Russia
"UKR"   # Ukraine
)
latin_america_bloc <- c(
"ARG",  # Argentina
"BRA",  # Brazil
"CHL",  # Chile
"COL",  # Colombia
"MEX",  # Mexico
"PER"   # Peru
)
other_countries_bloc <- c(
"AUS",  # Australia
"CAN",  # Canada
"CHE",  # Switzerland
"JPN",  # Japan
"KOR",  # Korea
"MYS",  # Malaysia
"PHL",  # Philippines
"SAU",  # Saudi Arabia
"THA",  # Thailand
"TUR",  # Türkiye
"ZAF",  # South Africa
"EGY",  # Egypt
"IND",  # India
"IDN"   # Indonesia
)
other_latin_countries_bloc <- c(
"ARG",  # Argentina
"BRA",  # Brazil
"CHL",  # Chile
"COL",  # Colombia
"MEX",  # Mexico
"PER",  # Peru
"AUS",  # Australia
"CAN",  # Canada
"CHE",  # Switzerland
"JPN",  # Japan
"KOR",  # Korea
"MYS",  # Malaysia
"PHL",  # Philippines
"SAU",  # Saudi Arabia
"THA",  # Thailand
"TUR",  # Türkiye
"ZAF",  # South Africa
"EGY",  # Egypt
"IND",  # India
"IDN"   # Indonesia
)
fragmentation_index_bloc <- read_xlsx("Geofragmentation Index/bloc_factors_fallf_QML.xlsx")
fragmentation_index_ctry <- read_xlsx("Geofragmentation Index/bloc_factor_countries_QML.xlsx")
fragmentation_index_Villaverde <- read_xlsx("Geofragmentation Index/Villaverde.xlsx")
fragmentation_index_Villaverde <- fragmentation_index_Villaverde[101:nrow(fragmentation_index_Villaverde),]
fragmentation_index_reg <- read_xlsx("Geofragmentation Index/bloc_factors_reg_PPP_QML.xlsx")
fragmentation_index_reg <- read_xlsx("Geofragmentation Index/bloc_factors_reg_PPP_QML.xlsx")
fragmentation_index_reg_new <- read_xlsx("var_data/geofrag_reg_factor.xlsx")
VIX <- read_xlsx("VIX/VIX.xlsx",sheet = "Data")
WTI <- read_xlsx("WTI/WTI.xlsx",sheet = "Data")
USTreasury <- read_xlsx("treasury_2year_spread/treasury2yearspread.xlsx", sheet = "Data")
NFCI <- read_xlsx("NFCI/NFCI.xlsx", sheet = "data")
# Variables Locales
ip <- read_xlsx("industrial production/ip_IMF.xlsx",sheet = "Data")
fi <- read_xlsx("fixed_investment/gross_fixed_investment_IMF.xlsx", sheet = "data")
sp <- read_xlsx("Stock Exchange/Stock Exchanger.xlsx", sheet = "Data")
fi$iso3 <- countrycode(fi$COUNTRY, origin = 'country.name', destination = 'iso3c')
ip$iso3 <- countrycode(ip$COUNTRY, origin = 'country.name', destination = 'iso3c')
countries <- c(unlist(fi$iso3))
ip <- ip %>% filter(iso3 %in% countries)
ip <- ip %>% pivot_longer(cols = -c(COUNTRY,iso3),names_to = "Quarter", values_to = "Value") %>%
select(-COUNTRY) %>% pivot_wider(names_from = iso3, values_from = Value) %>%  mutate(across(
.cols = -Quarter,  # replace with your column name (unquoted)
.fns = log
))
fi <- fi %>% pivot_longer(cols = -c(COUNTRY,iso3),names_to = "Quarter", values_to = "Value") %>%
select(-COUNTRY) %>% pivot_wider(names_from = iso3, values_from = Value) %>%  mutate(across(
.cols = -Quarter,  # replace with your column name (unquoted)
.fns = log
))
var <- names(fi)
sp <- sp %>% pivot_longer(-Quarter,names_to = "iso3", values_to = "Value") %>% filter(iso3 %in% countries) %>%
pivot_wider(names_from = iso3, values_from = Value) %>%  mutate(across(
.cols = -Quarter,  # replace with your column name (unquoted)
.fns = log
)) %>% select(var)
sp$Quarter <- ip$Quarter
NFCI <- NFCI %>%
bind_cols(replicate(29, NFCI$NFCI, simplify = FALSE) |>
setNames(paste0("your_column_", 1:29)))
names(NFCI) <- var
NFCI$Quarter <- ip$Quarter
USTreasury <- USTreasury %>%  bind_cols(replicate(29, USTreasury$`2_year_treasury`, simplify = FALSE) |>
setNames(paste0("your_column_", 1:29)))
names(USTreasury) <- var
USTreasury$Quarter <- ip$Quarter
VIX <- VIX %>%  bind_cols(replicate(29, VIX$VIX, simplify = FALSE) |>
setNames(paste0("your_column_", 1:29)))
names(VIX) <- var
VIX$Quarter <- ip$Quarter
WTI <- WTI %>%  bind_cols(replicate(29, WTI$WTI, simplify = FALSE) |>
setNames(paste0("your_column_", 1:29)))
names(WTI) <- var
WTI$Quarter <- ip$Quarter
fragmentation_index <- fragmentation_index_bloc %>% select(Quarter, wld) %>%
bind_cols(replicate(29, fragmentation_index_bloc$wld, simplify = FALSE) |>
setNames(paste0("your_column_", 1:29))) %>% mutate(across(-Quarter, scale))
names(fragmentation_index) <- var
fragmentation_index$Quarter <- ip$Quarter
fragmentation_index_Villaverde <- fragmentation_index_Villaverde %>% select(Time, wld) %>%
bind_cols(replicate(29, fragmentation_index_Villaverde$wld, simplify = FALSE) |>
setNames(paste0("your_column_", 1:29))) %>% mutate(across(-Time, scale))
names(fragmentation_index_Villaverde) <- var
fragmentation_index_Villaverde$Quarter <- ip$Quarter[1:97]
fragmentation_index_reg_wld <-  fragmentation_index_reg %>% select(Quarter, wld) %>%
bind_cols(replicate(29, fragmentation_index_reg$wld, simplify = FALSE) |>
setNames(paste0("your_column_", 1:29))) %>% mutate(across(-Quarter, scale))
names(fragmentation_index_reg_wld) <- var
fragmentation_index_reg_wld$Quarter <- ip$Quarter
fragmentation_index_ctry <- fragmentation_index_ctry %>% select(var) %>% mutate(across(-Quarter, scale))
fragmentation_index_ctry$Quarter <- ip$Quarter
# Creating the fragmentation base for bloc
fragmentation_index_reg_ctry <-  fragmentation_index_reg%>% select(Quarter)
for (ctry in var[-1]){
if (ctry %in% us_eu_bloc){
fragmentation_index_reg_ctry[[ctry]] <- fragmentation_index_reg[["useu"]]
}
if (ctry %in% latin_america_bloc){
fragmentation_index_reg_ctry[[ctry]] <- fragmentation_index_reg[["lac"]]
}
if (ctry %in% other_countries_bloc){
fragmentation_index_reg_ctry[[ctry]] <- fragmentation_index_reg[["other"]]
}
if (ctry %in% chn_rus_bloc){
fragmentation_index_reg_ctry[[ctry]] <- fragmentation_index_reg[["chnrus"]]
}
}
fragmentation_index_reg_ctry_new <-  fragmentation_index_reg%>% select(Quarter)
for (ctry in var[-1]){
if (ctry %in% us_eu_bloc){
fragmentation_index_reg_ctry_new[[ctry]] <- fragmentation_index_reg_new[["useu"]]
}
if (ctry %in% latin_america_bloc){
fragmentation_index_reg_ctry_new[[ctry]] <- fragmentation_index_reg_new[["lac"]]
}
if (ctry %in% other_countries_bloc){
fragmentation_index_reg_ctry_new[[ctry]] <- fragmentation_index_reg_new[["other"]]
}
if (ctry %in% chn_rus_bloc){
fragmentation_index_reg_ctry_new[[ctry]] <- fragmentation_index_reg_new[["chnrus"]]
}
}
fragmentation_index_reg_ctry <- fragmentation_index_reg_ctry %>% select(var) %>% mutate(across(-Quarter, scale))
fragmentation_index_reg_ctry_new <- fragmentation_index_reg_ctry_new %>% select(var) %>% mutate(across(-Quarter, scale))
fragmentation_index_reg_ctry$Quarter <- ip$Quarter
fragmentation_index_reg_ctry_new$Quarter <- ip$Quarter
fragmentation_index_bloc_ctry <-  fragmentation_index_bloc %>% select(Quarter)
for (ctry in var[-1]){
if (ctry %in% us_eu_bloc){
fragmentation_index_bloc_ctry[[ctry]] <- fragmentation_index_bloc[["useu"]]
}
if (ctry %in% latin_america_bloc){
fragmentation_index_bloc_ctry[[ctry]] <- fragmentation_index_bloc[["lac"]]
}
if (ctry %in% other_countries_bloc){
fragmentation_index_bloc_ctry[[ctry]] <- fragmentation_index_bloc[["other"]]
}
if (ctry %in% chn_rus_bloc){
fragmentation_index_bloc_ctry[[ctry]] <- fragmentation_index_bloc[["chnrus"]]
}
}
fragmentation_index_bloc_ctry <- fragmentation_index_bloc_ctry %>% select(var) %>% mutate(across(-Quarter, scale))
fragmentation_index_bloc_ctry$Quarter <- ip$Quarter
# Desason sp, ip, and FI
deseasonalize <- function(x) {
# If too many NAs or too short, return as is
ts_x <- ts(x, frequency = 4,start= c(2000,1))  # quarterly
out <- final(seas(ts_x, x11 = "")) # fallback if fails
return(out)
}
ip <- ip %>% mutate(across(-Quarter, deseasonalize)) %>%
mutate(across(-Quarter, ~ rollsum(.x, 4, fill = NA, align = "right")))
fi <- fi %>% mutate(across(-Quarter, deseasonalize))%>%
mutate(across(-Quarter, ~ rollsum(.x, 4, fill = NA, align = "right")))
sp <- sp %>% mutate(across(-Quarter, deseasonalize))
# Saving the files
write_xlsx(ip,"var_data/ip.xlsx")
write_xlsx(fi,"var_data/fi.xlsx")
write_xlsx(sp,"var_data/sp.xlsx")
write_xlsx(NFCI,"var_data/NFCI.xlsx")
write_xlsx(USTreasury,"var_data/USTreasury.xlsx")
write_xlsx(VIX,"var_data/VIX.xlsx")
write_xlsx(WTI,"var_data/WTI.xlsx")
write_xlsx(fragmentation_index,"var_data/fragmentation_wld.xlsx")
write_xlsx(fragmentation_index_ctry,"var_data/fragmentation_ctry.xlsx")
write_xlsx(fragmentation_index_Villaverde,"var_data/fragmentation_ctry_Villaverde.xlsx")
write_xlsx(fragmentation_index_reg_wld,"var_data/fragmentation_index_reg_wld.xlsx")
#-------------------------------------------------------------------------------
ip_long <- ip %>% pivot_longer(cols = -Quarter,names_to = "country", values_to = "values") %>% mutate(Variable = "ip")
sp_long <- sp %>% pivot_longer(cols = -Quarter,names_to = "country", values_to = "values") %>% mutate(Variable = "sp")
fi_long <- fi %>% pivot_longer(cols = -Quarter,names_to = "country", values_to = "values") %>% mutate(Variable = "fi")
NFCI_long <- NFCI %>% pivot_longer(cols = -Quarter,names_to = "country", values_to = "values") %>% mutate(Variable = "NFCI")
USTreasury_long <- USTreasury %>% pivot_longer(cols = -Quarter,names_to = "country", values_to = "values") %>% mutate(Variable = "USTreasury")
WTI_long <- WTI %>% pivot_longer(cols = -Quarter,names_to = "country", values_to = "values") %>% mutate(Variable = "WTI")
VIX_long <- VIX %>% pivot_longer(cols = -Quarter,names_to = "country", values_to = "values") %>% mutate(Variable = "VIX")
fragmentation_index_long <- fragmentation_index %>% pivot_longer(cols = -Quarter,names_to = "country", values_to = "values") %>% mutate(Variable = "fragmentation_index")
fragmentation_index_ctry_long <- fragmentation_index_ctry %>% pivot_longer(cols = -Quarter,names_to = "country", values_to = "values") %>% mutate(Variable = "fragmentation_index_ctry")
fragmentation_index_Villaverde_long <- fragmentation_index_Villaverde %>% pivot_longer(cols = -Quarter,names_to = "country", values_to = "values") %>% mutate(Variable = "fragmentation_index_Villaverde")
fragmentation_index_reg_wld_long <- fragmentation_index_reg_wld %>% pivot_longer(cols = -Quarter,names_to = "country", values_to = "values") %>% mutate(Variable = "fragmentation_index_reg_wld")
fragmentation_index_reg_ctry_long <- fragmentation_index_reg_ctry %>% pivot_longer(cols = -Quarter,names_to = "country", values_to = "values") %>% mutate(Variable = "fragmentation_index_reg_ctry")
fragmentation_index_reg_ctry_new_long <- fragmentation_index_reg_ctry_new %>% pivot_longer(cols = -Quarter,names_to = "country", values_to = "values") %>% mutate(Variable = "fragmentation_index_reg_ctry_new")
data_var <- rbind(ip_long,sp_long,fi_long,NFCI_long,VIX_long, USTreasury_long,WTI_long,fragmentation_index_long,fragmentation_index_ctry_long,
fragmentation_index_Villaverde_long,fragmentation_index_reg_wld_long,fragmentation_index_reg_ctry_long,fragmentation_index_reg_ctry_new_long)
data_var <- data_var %>% pivot_wider(names_from = "Variable", values_from = "values")
write_xlsx(data_var,"var_data/data_var.xlsx")
View(data_var)
setwd("C:/Users/lveras/OneDrive - FLAR/Work/Actividades/Geoconomic Fragmentation/Data/var_data")
library(readxl)
library(panelvar)
data <- read_xlsx("data_var.xlsx")
data <- data.frame(data)
View(data)
names(data)
data <- data.frame(data)
pvar_model <- pvarfeols(
dependent_vars = c("fragmentation_index_reg_ctry_new","sp","ip","fi"),
lags = 1,
transformation = "demean",
data = data,
panel_identifier = c("country", "Quarter")
)
irf <- oirf(pvar_model, n.ahead = 20)
plot((irf$fragmentation_index_reg_ctry_new[,1]))
plot((irf$fragmentation_index_reg_ctry_new[,1]), type = "line")
g <- irf$fragmentation_index_reg_ctry_new
View(g)
pvar_model <- pvarfeols(
dependent_vars = c("fragmentation_index_reg_ctry_new","sp","ip","fi"),
lags = 2,
transformation = "demean",
data = data,
panel_identifier = c("country", "Quarter")
)
irf <- oirf(pvar_model, n.ahead = 20)
View(g)
setwd("C:/Users/lveras/OneDrive - FLAR/Work/Actividades/Geoconomic Fragmentation/Data/var_data")
library(readxl)
library(panelvar)
data <- read_xlsx("data_var.xlsx")
data <- data.frame(data)
pvar_model <- pvarfeols(
dependent_vars = c("fragmentation_index_reg_ctry_new","sp","ip","fi"),
lags = 2,
transformation = "demean",
data = data,
panel_identifier = c("country", "Quarter")
)
irf <- oirf(pvar_model, n.ahead = 20)
irf_ci <- bootstrap_irf(pvar_model, typeof_irf = c("OIRF"),
n.ahead = 20,
nof_Nstar_draws = 5000,
confidence.band = 0.90)
names(data)
pvar_model <- pvarfeols(
dependent_vars = c("fragmentation_index_reg_ctry_new","VIX","NFCI","USTreasury","WTI","sp","ip","fi"),
lags = 2,
transformation = "demean",
data = data,
panel_identifier = c("country", "Quarter")
)
irf <- oirf(pvar_model, n.ahead = 20)
pvar_model <- pvarfeols(
dependent_vars = c("fragmentation_index_reg_ctry_new","sp","ip","fi"),
lags = 2,
transformation = "demean",
data = data,
panel_identifier = c("country", "Quarter")
)
irf <- oirf(pvar_model, n.ahead = 20)
g <- irf$fragmentation_index_reg_ctry_new
View(g)
pvar_model <- pvarfeols(
dependent_vars = c("fragmentation_index_reg_ctry_new","VIX","NFCI","USTreasury","WTI","sp","ip","fi"),
lags = 2,
transformation = "demean",
data = data,
panel_identifier = c("country", "Quarter")
)
irf <- oirf(pvar_model, n.ahead = 20)
g <- irf$fragmentation_index_reg_ctry_new
View(data)
View(g)
pvar_model <- pvarfeols(
dependent_vars = c("fragmentation_index_reg_ctry_new","VIX","NFCI","USTreasury","WTI","sp","ip","fi"),
lags = 2,
transformation = "fd",
data = data,
panel_identifier = c("country", "Quarter")
)
irf <- oirf(pvar_model, n.ahead = 20)
g <- irf$fragmentation_index_reg_ctry_new
View(g)
setwd("C:/Users/lveras/OneDrive - FLAR/Work/Actividades/Geoconomic Fragmentation/Data/var_data")
library(readxl)
library(panelvar)
data <- read_xlsx("data_var.xlsx")
data <- data.frame(data)
pvar_model <- pvarfeols(
dependent_vars = c("fragmentation_index_reg_ctry_new","VIX","NFCI","USTreasury","WTI","sp","ip","fi"),
lags = 2,
transformation = "demean",
data = data,
panel_identifier = c("country", "Quarter")
)
irf <- oirf(pvar_model, n.ahead = 20)
g <- irf$fragmentation_index_reg_ctry_new
View(g)
?unnest_tokens
setwd("C:/Users/lveras/OneDrive - FLAR/Personal/Repositorios de Github/PS3_Equipo3/stores/")
require(pacman)
p_load("tidyverse","textir","wordcloud","tidytext","stopwords","glmnet")
